# μ‹μ¤ν… μ•„ν‚¤ν…μ² μ„¤κ³„μ„
## PUBC μ—°λ™ ν…μ¤νΈ ν”„λ΅μ νΈ

**μ‘μ„±μΌ**: 2025-11-04
**ν”„λ΅μ νΈλ…**: PUBC-Test-API
**λ²„μ „**: 2.0 (JDK 1.8)
**μ•„ν‚¤ν…μ²**: μ΅°ν μ „μ© (Read-Only API)

> **π“ κΈ°μ  μ¤νƒ**: μ΄ λ¬Έμ„λ” **[JDK 1.8 κΈ°μ  μ¤νƒ](./00_κΈ°μ μ¤νƒ_JDK18.md)** κΈ°μ¤€μΌλ΅ μ‘μ„±λμ—μµλ‹λ‹¤.
> - Java 8 (Lambda, Stream, Optional ν™μ©)
> - Spring 4.3.30, Apache CXF 3.3.13
> - MyBatis 3.5.13 + iBATIS 2.3.4 κ³µμ΅΄ κµ¬μ΅°
>
> **π“ API νΉμ§•**: μ΄ ν”„λ΅μ νΈλ” **κ³µκ³µλ°μ΄ν„° μ΅°ν μ „μ© API**μ…λ‹λ‹¤.
> - λ„λ©”μΈ: λ¬Έν™”μ‹μ„¤(CultureFacility) μ •λ³΄ μ΅°ν
> - API μ ν•: μ΅°ν μ „μ© (GET μ”μ²­λ§, POST/PUT/DELETE μ—†μ)
> - λ°μ΄ν„°: TB_CULTURE_FACILITY

---

## 1. μ‹μ¤ν… κ°μ”

### 1.1 μ‹μ¤ν… λ©μ 
PUBC κ³µν†µμ—°κ³„λ¨λ“μ„ ν™μ©ν• ν‘μ¤€ν™”λ OpenAPI μ„λΉ„μ¤ μ κ³µ μ‹μ¤ν…μΌλ΅, REST λ° SOAP λ°©μ‹μ APIλ¥Ό ν†µν•΄ **κ³µκ³µ λ¬Έν™”μ‹μ„¤ μ •λ³΄ μ΅°ν κΈ°λ¥**μ„ μ κ³µν•©λ‹λ‹¤.

> **μ¤‘μ”**: μ΄ μ‹μ¤ν…μ€ **μ΅°ν μ „μ©(Read-Only)** APIμ…λ‹λ‹¤. λ°μ΄ν„° μƒμ„±/μμ •/μ‚­μ  κΈ°λ¥μ€ μ κ³µν•μ§€ μ•μµλ‹λ‹¤.

### 1.2 μ‹μ¤ν… κµ¬μ„±λ„

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     ν΄λΌμ΄μ–ΈνΈ κ³„μΈµ                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                     β”‚
β”‚  β”‚ REST Client  β”‚      β”‚ SOAP Client  β”‚                     β”‚
β”‚  β”‚  (JSON/XML)  β”‚      β”‚   (WSDL)     β”‚                     β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
            β†“                       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     ν”„λ μ  ν…μ΄μ… κ³„μΈµ                            β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚  β”‚         Apache CXF Servlet (CXFServlet)              β”‚   β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚   β”‚
β”‚  β”‚  β”‚ JAX-RS         β”‚      β”‚ JAX-WS         β”‚          β”‚   β”‚
β”‚  β”‚  β”‚ (REST Endpoint)β”‚      β”‚ (SOAP Endpoint)β”‚          β”‚   β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”          β”‚   β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚                                                             β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚  β”‚            Spring MVC Controllers                    β”‚   β”‚
β”‚  β”‚  - CultureFacilityRestController (REST API μ΅°ν μ „μ©)β”‚   β”‚
β”‚  β”‚  - CultureFacilitySoapService (SOAP Service μ΅°ν μ „μ©)β”‚   β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
            β†“                       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     μΈμ¦/λ΅κΉ… κ³„μΈµ (PUBC)                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚  β”‚                  CommonProc.java                     β”‚   β”‚
β”‚  β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚   β”‚
β”‚  β”‚  β”‚ authServiceCall(request) β†’ UserCrtfcVO λ°ν™     β”‚  β”‚   β”‚
β”‚  β”‚  β”‚ useSttusServiceCall(userCrtfcVO) β†’ λ΅κΉ…         β”‚  β”‚   β”‚
β”‚  β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚   β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚                 β†“                         β†“                 β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚  β”‚ UserCrtfcProcessService β”‚  β”‚    UseSttusService      β”‚   β”‚
β”‚  β”‚  (PUBC μΈμ¦ λ¨λ“)         β”‚  β”‚   (PUBC λ΅κΉ… λ¨λ“)        β”‚   β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
            β†“                       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     λΉ„μ¦λ‹μ¤ λ΅μ§ κ³„μΈµ                          β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚  β”‚              Service Layer (μ΅°ν μ „μ©)                 β”‚   β”‚
β”‚  β”‚  - CultureFacilityService (μΈν„°νμ΄μ¤)                 β”‚   β”‚
β”‚  β”‚  - CultureFacilityServiceImpl (κµ¬ν„μ²΄)                β”‚   β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
            β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµ                            β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β”‚  β”‚          DAO Layer (MyBatis Mapper Interface)        β”‚   β”‚
β”‚  β”‚  - CultureFacilityMapper (MyBatis @Mapper)           β”‚   β”‚
β”‚  β”‚    * SELECT μΏΌλ¦¬λ§ μ κ³µ (INSERT/UPDATE/DELETE μ—†μ)    β”‚   β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”   β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
            β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                     λ°μ΄ν„°λ² μ΄μ¤ κ³„μΈµ                           β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”‚
β”‚  β”‚  Application DB       β”‚      β”‚    PUBC DB          β”‚      β”‚
β”‚  β”‚  - TB_CULTURE_FACILITYβ”‚      β”‚ - TN_PUBC_USE_STTUS β”‚      β”‚
β”‚  β”‚    (κ³µκ³µ λ¬Έν™”μ‹μ„¤ μ •λ³΄) β”‚      β”‚ - TN_PUBC_USER_CRTFCβ”‚      β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## 2. κ³„μΈµλ³„ μƒμ„Έ μ„¤κ³„

### 2.1 ν”„λ μ  ν…μ΄μ… κ³„μΈµ (Presentation Layer)

#### 2.1.1 REST API μ—”λ“ν¬μΈνΈ (JAX-RS)

**κΈ°μ  μ¤νƒ**:
- Apache CXF 3.3.13
- JAX-RS 2.1
- Spring MVC Integration

**REST Controller κµ¬μ΅°** (μ΅°ν μ „μ©):
```java
@Path("/api")
@Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
public class CultureFacilityRestController {

    @Autowired
    private CultureFacilityService facilityService;

    @Autowired
    private CommonProc commonProc;  // PUBC ν†µν•©

    @GET
    @Path("/cultureFacilities")
    public Response getCultureFacilityList(
        @QueryParam("serviceKey") String serviceKey,
        @QueryParam("facilityType") String facilityType,      // λ°•λ¬Όκ΄€, λ―Έμ κ΄€, λ„μ„κ΄€
        @QueryParam("regionCode") String regionCode,          // 11(μ„μΈ), 26(λ¶€μ‚°), 41(κ²½κΈ°)
        @QueryParam("facilityName") String facilityName,      // μ‹μ„¤λ… κ²€μƒ‰
        @QueryParam("pageNo") @DefaultValue("1") int pageNo,
        @QueryParam("numOfRows") @DefaultValue("10") int numOfRows,
        @Context HttpServletRequest request
    ) {
        // 1. PUBC μΈμ¦
        UserCrtfcVO userCrtfcVO = commonProc.authServiceCall(request);

        // 2. μΈμ¦ κ²€μ¦
        if (!"00".equals(userCrtfcVO.getTroblTyCode())) {
            return createErrorResponse(userCrtfcVO);
        }

        try {
            // 3. λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰ (μ΅°ν μ „μ©)
            List<CultureFacilityVO> facilities = facilityService.getFacilityList(
                facilityType, regionCode, facilityName, pageNo, numOfRows
            );

            int totalCount = facilityService.getTotalCount(facilityType, regionCode, facilityName);

            // 4. μ‘λ‹µ μƒμ„±
            return createSuccessResponse(facilities, totalCount, pageNo, numOfRows);

        } catch (Exception e) {
            // 5. μμ™Έ μ²λ¦¬
            userCrtfcVO.setTroblTyCode("99");
            userCrtfcVO.setTroblCn(e.getMessage());
            return createErrorResponse(userCrtfcVO);

        } finally {
            // 6. μ‚¬μ© ν„ν™© λ΅κΉ…
            commonProc.useSttusServiceCall(userCrtfcVO);
        }
    }
}
```

**URL λ§¤ν•‘** (μ΅°ν μ „μ©):
- `GET /api/cultureFacilities` - λ¬Έν™”μ‹μ„¤ λ©λ΅ μ΅°ν (ν•„ν„°λ§: facilityType, regionCode, facilityName)
- `GET /api/cultureFacilities/{facilityId}` - λ¬Έν™”μ‹μ„¤ μƒμ„Έ μ΅°ν

> **π“ μ΅°ν μ „μ© API**: POST/PUT/DELETE μ—”λ“ν¬μΈνΈλ” μ κ³µν•μ§€ μ•μµλ‹λ‹¤.

#### 2.1.2 SOAP μ›Ή μ„λΉ„μ¤ μ—”λ“ν¬μΈνΈ (JAX-WS)

**κΈ°μ  μ¤νƒ**:
- Apache CXF 3.3.13
- JAX-WS 2.3
- WSDL μλ™ μƒμ„±

**SOAP Service κµ¬μ΅°** (μ΅°ν μ „μ©):
```java
@WebService(
    serviceName = "CultureFacilityService",
    portName = "CultureFacilityServicePort",
    targetNamespace = "http://service.soap.test.pubc.iros/"
)
public class CultureFacilitySoapService {

    @Autowired
    private CultureFacilityService facilityService;

    @Autowired
    private CommonProc commonProc;

    @WebMethod
    @WebResult(name = "facilities")
    public FacilityListResponse getCultureFacilityList(
        @WebParam(name = "serviceKey") String serviceKey,
        @WebParam(name = "facilityType") String facilityType,     // λ°•λ¬Όκ΄€, λ―Έμ κ΄€, λ„μ„κ΄€
        @WebParam(name = "regionCode") String regionCode,         // 11(μ„μΈ), 26(λ¶€μ‚°), 41(κ²½κΈ°)
        @WebParam(name = "facilityName") String facilityName,     // μ‹μ„¤λ… κ²€μƒ‰
        @WebParam(name = "pageNo") Integer pageNo,
        @WebParam(name = "numOfRows") Integer numOfRows
    ) throws ServiceException {

        HttpServletRequest request = getHttpServletRequest();

        // 1. PUBC μΈμ¦
        UserCrtfcVO userCrtfcVO = commonProc.authServiceCall(request);

        // 2. μΈμ¦ κ²€μ¦ λ° λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰
        if (!"00".equals(userCrtfcVO.getTroblTyCode())) {
            throw new ServiceException(userCrtfcVO.getTroblCn());
        }

        try {
            // μ΅°ν μ „μ© - SELECTλ§ μ‹¤ν–‰
            List<CultureFacilityVO> facilities = facilityService.getFacilityList(
                facilityType,
                regionCode,
                facilityName,
                pageNo != null ? pageNo : 1,
                numOfRows != null ? numOfRows : 10
            );

            int totalCount = facilityService.getTotalCount(facilityType, regionCode, facilityName);

            return new FacilityListResponse("000", "OK", facilities, totalCount);

        } catch (Exception e) {
            userCrtfcVO.setTroblTyCode("99");
            userCrtfcVO.setTroblCn(e.getMessage());
            throw new ServiceException(e.getMessage());

        } finally {
            commonProc.useSttusServiceCall(userCrtfcVO);
        }
    }
}
```

**WSDL μ ‘κ·Ό**:
- `http://host:port/services/CultureFacilityService?wsdl`

**SOAP μ‘μ—…** (μ΅°ν μ „μ©):
- `getCultureFacilityList` - λ¬Έν™”μ‹μ„¤ λ©λ΅ μ΅°ν
- `getCultureFacility` - λ¬Έν™”μ‹μ„¤ μƒμ„Έ μ΅°ν

> **π“ μ΅°ν μ „μ©**: createFacility, updateFacility, deleteFacility μ‘μ—…μ€ μ κ³µν•μ§€ μ•μµλ‹λ‹¤.

### 2.2 μΈμ¦/λ΅κΉ… κ³„μΈµ (PUBC Integration Layer)

#### 2.2.1 CommonProc ν†µν•© ν΄λμ¤

**μ—­ν• **:
- PUBC λ¨λ“κ³Όμ λΈλ¦¬μ§€ μ—­ν• 
- μΈμ¦ λ° λ΅κΉ… μ²λ¦¬ ν†µν•©

**ν΄λμ¤ κµ¬μ΅°**:
```java
@Component
public class CommonProc {

    @Resource(name = "UserCrtfcProcessService")
    private UserCrtfcProcessService userCrtfcProcessService;

    @Resource(name = "UseSttusService")
    private UseSttusService useSttusService;

    /**
     * OpenAPI μΈμ¦ μ²λ¦¬
     * @param request HTTP μ”μ²­
     * @return UserCrtfcVO μΈμ¦ κ²°κ³Ό VO
     */
    public UserCrtfcVO authServiceCall(HttpServletRequest request) {
        UserCrtfcVO userCrtfcVO = null;

        try {
            // PUBC μΈμ¦ λ¨λ“ νΈμ¶
            userCrtfcVO = userCrtfcProcessService.userCrtfcProcess(request);

            // μΈμ¦ μ‹¤ν¨ μ‹ μ¦‰μ‹ λ΅κΉ…
            if (!"00".equals(userCrtfcVO.getTroblTyCode())) {
                useSttusService.insertUseSttus(userCrtfcVO);
            }

        } catch (Exception e) {
            // μμ™Έ λ°μƒ μ‹ κΈ°λ³Έ μ—λ¬ VO μƒμ„±
            userCrtfcVO = new UserCrtfcVO();
            userCrtfcVO.setTroblTyCode(PubcErrorCodeProperties.APPLICATION_ERROR);
            userCrtfcVO.setTroblCn(e.getMessage());
        }

        return userCrtfcVO;
    }

    /**
     * μ‚¬μ© ν„ν™© λ΅κΉ…
     * @param userCrtfcVO μΈμ¦ μ •λ³΄ VO
     */
    public void useSttusServiceCall(UserCrtfcVO userCrtfcVO) {
        try {
            if ("00".equals(userCrtfcVO.getTroblTyCode())) {
                useSttusService.insertUseSttus(userCrtfcVO);
            }
        } catch (Exception e) {
            // λ΅κΉ… μ‹¤ν¨ μ‹ μ‹μ¤ν… λ΅κ·Έλ§ κΈ°λ΅
            e.printStackTrace();
        }
    }
}
```

#### 2.2.2 PUBC λ¨λ“ ν†µν•©

**Spring Bean μ„¤μ •**:
```xml
<!-- PUBC Spring μ„¤μ • λ΅λ“ -->
<import resource="classpath:iros/pubc/spring/context-common-pubc.xml"/>
<import resource="classpath:iros/pubc/spring/context-datasource-pubc.xml"/>
<import resource="classpath:iros/pubc/spring/context-sqlMap-pubc.xml"/>
<import resource="classpath:iros/pubc/spring/context-idgen-pubc.xml"/>
```

**PUBC μ£Όμ” Bean**:
- `UserCrtfcProcessService`: μΈμ¦ μ²λ¦¬ μ„λΉ„μ¤
- `UseSttusService`: μ‚¬μ© ν„ν™© λ΅κΉ… μ„λΉ„μ¤
- `sqlMapClient`: iBATIS SQL Map ν΄λΌμ΄μ–ΈνΈ

### 2.3 λΉ„μ¦λ‹μ¤ λ΅μ§ κ³„μΈµ (Business Logic Layer)

#### 2.3.1 Service μΈν„°νμ΄μ¤ (μ΅°ν μ „μ©)

```java
public interface CultureFacilityService {

    /**
     * λ¬Έν™”μ‹μ„¤ λ©λ΅ μ΅°ν
     * @param facilityType μ‹μ„¤ μ ν• (λ°•λ¬Όκ΄€, λ―Έμ κ΄€, λ„μ„κ΄€ λ“±)
     * @param regionCode μ§€μ—­ μ½”λ“ (11: μ„μΈ, 26: λ¶€μ‚°, 41: κ²½κΈ° λ“±)
     * @param facilityName μ‹μ„¤λ… (λ¶€λ¶„ μΌμΉ κ²€μƒ‰)
     * @param pageNo νμ΄μ§€ λ²νΈ
     * @param numOfRows νμ΄μ§€λ‹Ή ν–‰ μ
     * @return λ¬Έν™”μ‹μ„¤ λ©λ΅
     */
    List<CultureFacilityVO> getFacilityList(
        String facilityType,
        String regionCode,
        String facilityName,
        int pageNo,
        int numOfRows
    ) throws Exception;

    /**
     * λ¬Έν™”μ‹μ„¤ μƒμ„Έ μ΅°ν
     * @param facilityId μ‹μ„¤ ID
     * @return λ¬Έν™”μ‹μ„¤ μƒμ„Έ μ •λ³΄
     */
    CultureFacilityVO getFacility(String facilityId) throws Exception;

    /**
     * λ¬Έν™”μ‹μ„¤ μ΄ κ°μ μ΅°ν
     * @param facilityType μ‹μ„¤ μ ν•
     * @param regionCode μ§€μ—­ μ½”λ“
     * @param facilityName μ‹μ„¤λ…
     * @return μ΄ κ°μ
     */
    int getTotalCount(String facilityType, String regionCode, String facilityName)
        throws Exception;
}
```

> **π“ μ΅°ν μ „μ©**: createFacility, updateFacility, deleteFacility λ©”μ„λ“λ” μ κ³µν•μ§€ μ•μµλ‹λ‹¤.

#### 2.3.2 Service κµ¬ν„μ²΄ (μ΅°ν μ „μ©)

```java
@Service("cultureFacilityService")
public class CultureFacilityServiceImpl implements CultureFacilityService {

    @Autowired
    private CultureFacilityMapper facilityMapper;

    @Override
    public List<CultureFacilityVO> getFacilityList(
        String facilityType,
        String regionCode,
        String facilityName,
        int pageNo,
        int numOfRows
    ) throws Exception {

        // νμ΄μ§• νλΌλ―Έν„° κ³„μ‚°
        int offset = (pageNo - 1) * numOfRows;

        // MyBatis Mapper νΈμ¶
        Map<String, Object> params = new HashMap<String, Object>();
        params.put("facilityType", facilityType);
        params.put("regionCode", regionCode);
        params.put("facilityName", facilityName);
        params.put("offset", offset);
        params.put("limit", numOfRows);

        return facilityMapper.selectFacilityList(params);
    }

    @Override
    public CultureFacilityVO getFacility(String facilityId) throws Exception {
        if (facilityId == null || facilityId.trim().isEmpty()) {
            throw new IllegalArgumentException("μ‹μ„¤ IDλ” ν•„μμ…λ‹λ‹¤.");
        }

        CultureFacilityVO facility = facilityMapper.selectFacility(facilityId);
        if (facility == null) {
            throw new Exception("λ¬Έν™”μ‹μ„¤μ„ μ°Ύμ„ μ μ—†μµλ‹λ‹¤. (facilityId: " + facilityId + ")");
        }

        return facility;
    }

    @Override
    public int getTotalCount(String facilityType, String regionCode, String facilityName)
        throws Exception {

        Map<String, Object> params = new HashMap<String, Object>();
        params.put("facilityType", facilityType);
        params.put("regionCode", regionCode);
        params.put("facilityName", facilityName);

        return facilityMapper.selectTotalCount(params);
    }
}
```

> **π“ Java 8 ν™μ© μμ‹**:
> ```java
> // Lambdaμ™€ Stream APIλ¥Ό μ‚¬μ©ν• ν•„ν„°λ§ (μ„ νƒμ )
> List<CultureFacilityVO> museums = facilities.stream()
>     .filter(f -> "λ°•λ¬Όκ΄€".equals(f.getFacilityType()))
>     .collect(Collectors.toList());
>
> // Optionalμ„ μ‚¬μ©ν• μ•μ „ν• μ΅°ν
> Optional<CultureFacilityVO> facility = Optional.ofNullable(
>     facilityMapper.selectFacility(facilityId)
> );
> ```

### 2.4 λ°μ΄ν„° μ ‘κ·Ό κ³„μΈµ (Data Access Layer)

#### 2.4.1 MyBatis Mapper μΈν„°νμ΄μ¤ (μ΅°ν μ „μ©)

```java
@Mapper
public interface CultureFacilityMapper {

    /**
     * λ¬Έν™”μ‹μ„¤ λ©λ΅ μ΅°ν (μ΅°ν μ „μ©)
     */
    List<CultureFacilityVO> selectFacilityList(Map<String, Object> params);

    /**
     * λ¬Έν™”μ‹μ„¤ μƒμ„Έ μ΅°ν (μ΅°ν μ „μ©)
     */
    CultureFacilityVO selectFacility(String facilityId);

    /**
     * λ¬Έν™”μ‹μ„¤ μ΄ κ°μ μ΅°ν (μ΅°ν μ „μ©)
     */
    int selectTotalCount(Map<String, Object> params);
}
```

> **π“ μ΅°ν μ „μ©**: insertFacility, updateFacility, deleteFacility λ©”μ„λ“λ” μ κ³µν•μ§€ μ•μµλ‹λ‹¤.

#### 2.4.2 MyBatis XML Mapper

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="iros.test.facility.dao.CultureFacilityMapper">

    <!-- μ΅°ν μ „μ© ResultMap -->
    <resultMap id="facilityResult" type="iros.test.facility.vo.CultureFacilityVO">
        <id property="facilityId" column="FACILITY_ID"/>
        <result property="facilityName" column="FACILITY_NAME"/>
        <result property="facilityType" column="FACILITY_TYPE"/>
        <result property="address" column="ADDRESS"/>
        <result property="phone" column="PHONE"/>
        <result property="latitude" column="LATITUDE"/>
        <result property="longitude" column="LONGITUDE"/>
        <result property="openTime" column="OPEN_TIME"/>
        <result property="homepage" column="HOMEPAGE"/>
        <result property="regionCode" column="REGION_CODE"/>
        <result property="manageAgency" column="MANAGE_AGENCY"/>
        <result property="updateDate" column="UPDATE_DATE"/>
    </resultMap>

    <!-- λ¬Έν™”μ‹μ„¤ λ©λ΅ μ΅°ν (μ΅°ν μ „μ©) -->
    <select id="selectFacilityList" parameterType="map" resultMap="facilityResult">
        SELECT
            FACILITY_ID, FACILITY_NAME, FACILITY_TYPE,
            ADDRESS, PHONE, LATITUDE, LONGITUDE,
            OPEN_TIME, HOMEPAGE, REGION_CODE,
            MANAGE_AGENCY, UPDATE_DATE
        FROM TB_CULTURE_FACILITY
        WHERE 1=1
        <if test="facilityType != null and facilityType != ''">
            AND FACILITY_TYPE = #{facilityType}
        </if>
        <if test="regionCode != null and regionCode != ''">
            AND REGION_CODE = #{regionCode}
        </if>
        <if test="facilityName != null and facilityName != ''">
            AND FACILITY_NAME LIKE CONCAT('%', #{facilityName}, '%')
        </if>
        ORDER BY UPDATE_DATE DESC
        LIMIT #{limit} OFFSET #{offset}
    </select>

    <!-- λ¬Έν™”μ‹μ„¤ μƒμ„Έ μ΅°ν (μ΅°ν μ „μ©) -->
    <select id="selectFacility" parameterType="string" resultMap="facilityResult">
        SELECT
            FACILITY_ID, FACILITY_NAME, FACILITY_TYPE,
            ADDRESS, PHONE, LATITUDE, LONGITUDE,
            OPEN_TIME, HOMEPAGE, REGION_CODE,
            MANAGE_AGENCY, UPDATE_DATE
        FROM TB_CULTURE_FACILITY
        WHERE FACILITY_ID = #{facilityId}
    </select>

    <!-- λ¬Έν™”μ‹μ„¤ μ΄ κ°μ (μ΅°ν μ „μ©) -->
    <select id="selectTotalCount" parameterType="map" resultType="int">
        SELECT COUNT(*)
        FROM TB_CULTURE_FACILITY
        WHERE 1=1
        <if test="facilityType != null and facilityType != ''">
            AND FACILITY_TYPE = #{facilityType}
        </if>
        <if test="regionCode != null and regionCode != ''">
            AND REGION_CODE = #{regionCode}
        </if>
        <if test="facilityName != null and facilityName != ''">
            AND FACILITY_NAME LIKE CONCAT('%', #{facilityName}, '%')
        </if>
    </select>

</mapper>
```

> **π“ MyBatis νΉμ§•**:
> - `<if>` νƒκ·Έλ¥Ό μ‚¬μ©ν• λ™μ  SQL
> - `#{parameter}` PreparedStatement λ°”μΈλ”© (SQL Injection λ°©μ–΄)
> - INSERT/UPDATE/DELETE μΏΌλ¦¬ μ—†μ (μ΅°ν μ „μ©)

---

## 3. ν¨ν‚¤μ§€ κµ¬μ΅°

```
src/
β””β”€β”€ iros/
    β””β”€β”€ test/
        β”β”€β”€ common/                                # κ³µν†µ λ¨λ“
        β”‚   β”β”€β”€ CommonProc.java                    # PUBC ν†µν•© ν΄λμ¤
        β”‚   β”β”€β”€ Constants.java                     # μƒμ μ •μ
        β”‚   β””β”€β”€ util/
        β”‚       β”β”€β”€ JsonUtil.java                  # JSON μ ν‹Έλ¦¬ν‹°
        β”‚       β””β”€β”€ XmlUtil.java                   # XML μ ν‹Έλ¦¬ν‹°
        β”‚
        β”β”€β”€ rest/                                  # REST API (μ΅°ν μ „μ©)
        β”‚   β”β”€β”€ controller/
        β”‚   β”‚   β””β”€β”€ CultureFacilityRestController.java
        β”‚   β””β”€β”€ dto/
        β”‚       β”β”€β”€ ApiResponse.java               # κ³µν†µ μ‘λ‹µ DTO
        β”‚       β””β”€β”€ ErrorResponse.java             # μ—λ¬ μ‘λ‹µ DTO
        β”‚
        β”β”€β”€ soap/                                  # SOAP μ›Ή μ„λΉ„μ¤ (μ΅°ν μ „μ©)
        β”‚   β”β”€β”€ service/
        β”‚   β”‚   β””β”€β”€ CultureFacilitySoapService.java
        β”‚   β””β”€β”€ dto/
        β”‚       β”β”€β”€ FacilityListResponse.java
        β”‚       β””β”€β”€ ServiceException.java
        β”‚
        β”β”€β”€ facility/                              # λ¬Έν™”μ‹μ„¤ λ„λ©”μΈ (μ΅°ν μ „μ©)
        β”‚   β”β”€β”€ service/
        β”‚   β”‚   β”β”€β”€ CultureFacilityService.java    # μΈν„°νμ΄μ¤
        β”‚   β”‚   β””β”€β”€ CultureFacilityServiceImpl.java# κµ¬ν„μ²΄
        β”‚   β”β”€β”€ dao/
        β”‚   β”‚   β””β”€β”€ CultureFacilityMapper.java     # MyBatis Mapper
        β”‚   β””β”€β”€ vo/
        β”‚       β””β”€β”€ CultureFacilityVO.java         # Value Object
        β”‚
        β””β”€β”€ config/                                # μ„¤μ • ν΄λμ¤ (μ„ νƒμ‚¬ν•­)
            β””β”€β”€ CxfConfig.java

WebContent/
β”β”€β”€ WEB-INF/
β”‚   β”β”€β”€ web.xml                                    # μ›Ή μ• ν”λ¦¬μΌ€μ΄μ… μ„¤μ •
β”‚   β”β”€β”€ lib/
β”‚   β”‚   β”β”€β”€ iros_pubc_1.1.jar                      # PUBC λ¨λ“ (Ver.2.3)
β”‚   β”‚   β”β”€β”€ iros_cipher.jar                        # μ•”νΈν™”
β”‚   β”‚   β”β”€β”€ spring-*.jar                           # Spring 4.3.30
β”‚   β”‚   β”β”€β”€ cxf-*.jar                              # Apache CXF 3.3.13
β”‚   β”‚   β”β”€β”€ mybatis-*.jar                          # MyBatis 3.5.13
β”‚   β”‚   β”β”€β”€ ibatis-*.jar                           # iBATIS 2.3.4 (PUBCμ©)
β”‚   β”‚   β””β”€β”€ [κΈ°νƒ€ λΌμ΄λΈλ¬λ¦¬]
β”‚   β””β”€β”€ config/
β”‚       β”β”€β”€ spring/
β”‚       β”‚   β”β”€β”€ context-app.xml                    # μ• ν”λ¦¬μΌ€μ΄μ… μ„¤μ •
β”‚       β”‚   β”β”€β”€ context-datasource.xml             # λ°μ΄ν„°μ†μ¤
β”‚       β”‚   β”β”€β”€ context-mybatis.xml                # MyBatis μ„¤μ •
β”‚       β”‚   β”β”€β”€ context-cxf.xml                    # CXF μ„¤μ •
β”‚       β”‚   β””β”€β”€ context-transaction.xml            # νΈλμ­μ…
β”‚       β””β”€β”€ mybatis/
β”‚           β”β”€β”€ mybatis-config.xml                 # MyBatis μ„¤μ •
β”‚           β””β”€β”€ mapper/
β”‚               β””β”€β”€ CultureFacilityMapper.xml      # Facility Mapper
β”‚
β””β”€β”€ index.jsp                                      # ν…μ¤νΈ νμ΄μ§€
```

> **π“ μ΅°ν μ „μ© μ•„ν‚¤ν…μ²**:
> - `facility/` ν¨ν‚¤μ§€μ— SELECT μΏΌλ¦¬λ§ ν¬ν•¨
> - MyBatis Mapper μΈν„°νμ΄μ¤ μ‚¬μ© (`@Mapper` μ–΄λ…Έν…μ΄μ…)

---

## 4. λ°μ΄ν„° νλ¦„

### 4.1 REST API νΈμ¶ νλ¦„ (μ΅°ν μ „μ©)

```
[ν΄λΌμ΄μ–ΈνΈ]
    β†“ HTTP GET /api/cultureFacilities?serviceKey=xxx&facilityType=λ°•λ¬Όκ΄€&regionCode=11
[CXF JAX-RS Servlet]
    β†“ λΌμ°ν…
[CultureFacilityRestController]
    β†“ authServiceCall(request)
[CommonProc]
    β†“ userCrtfcProcess(request)
[PUBC UserCrtfcProcessService]
    β†“ μ„λΉ„μ¤ν‚¤ κ²€μ¦ (DB μ΅°ν)
[PUBC Database: TN_PUBC_USER_CRTFC]
    β†“ UserCrtfcVO λ°ν™ (troblTyCode="00")
[CultureFacilityRestController]
    β†“ μΈμ¦ μ„±κ³µ β†’ facilityService.getFacilityList()
[CultureFacilityServiceImpl]
    β†“ facilityMapper.selectFacilityList()
[CultureFacilityMapper (MyBatis)]
    β†“ SELECT μΏΌλ¦¬ μ‹¤ν–‰ (μ΅°ν μ „μ©)
[Application Database: TB_CULTURE_FACILITY]
    β†“ List<CultureFacilityVO> λ°ν™
[CultureFacilityRestController]
    β†“ createSuccessResponse(facilities) β†’ JSON λ³€ν™
[CXF JAX-RS]
    β†“ HTTP 200 OK + JSON Body
[ν΄λΌμ΄μ–ΈνΈ]

[Finally Block]
    β†“ useSttusServiceCall(userCrtfcVO)
[PUBC UseSttusService]
    β†“ insertUseSttus(userCrtfcVO)
[PUBC Database: TN_PUBC_USE_STTUS_INFO]
    β†“ μ‚¬μ© ν„ν™© λ΅κΉ… μ™„λ£
```

> **π“ μ΅°ν μ „μ© νΉμ§•**:
> - MyBatis Mapperλ” SELECT μΏΌλ¦¬λ§ μ‹¤ν–‰
> - DB νΈλμ­μ… λ¶ν•„μ” (μ½κΈ° μ „μ©)
> - PUBC λ΅κΉ…μ€ μ •μƒ λ™μ‘ (INSERTλ” PUBC μμ—­)

### 4.2 SOAP μ›Ή μ„λΉ„μ¤ νΈμ¶ νλ¦„ (μ΅°ν μ „μ©)

```
[SOAP ν΄λΌμ΄μ–ΈνΈ]
    β†“ SOAP Envelope (getCultureFacilityList μ”μ²­)
[CXF JAX-WS Servlet]
    β†“ WSDL λ§¤ν•‘
[CultureFacilitySoapService]
    β†“ authServiceCall(request)
[PUBC μΈμ¦ λ¨λ“]
    β†“ UserCrtfcVO (μΈμ¦ μ„±κ³µ)
[CultureFacilitySoapService]
    β†“ facilityService.getFacilityList()
[λΉ„μ¦λ‹μ¤ λ΅μ§ μ‹¤ν–‰ - μ΅°ν μ „μ©]
    β†“ List<CultureFacilityVO>
[CultureFacilitySoapService]
    β†“ FacilityListResponse μƒμ„±
[CXF JAX-WS]
    β†“ SOAP Envelope μ‘λ‹µ (XML)
[SOAP ν΄λΌμ΄μ–ΈνΈ]

[Finally Block]
    β†“ PUBC λ΅κΉ…
```

---

## 5. κΈ°μ  μ¤νƒ

### 5.1 λ°±μ—”λ“ ν”„λ μ„μ›ν¬

| κΈ°μ  | λ²„μ „ | μ©λ„ |
|------|------|------|
| **Java** | JDK 1.8 | κ°λ° μ–Έμ–΄ (Lambda, Stream, Optional) |
| **Spring Framework** | 4.3.30.RELEASE | IoC, DI, MVC, νΈλμ­μ… κ΄€λ¦¬ |
| **Apache CXF** | 3.3.13 | JAX-WS (SOAP), JAX-RS (REST) |
| **MyBatis** | 3.5.13 | SQL Mapping, Mapper Interface |
| **iBATIS** | 2.3.4 | PUBC λ¨λ“μ© (κ³µμ΅΄) |
| **PUBC λ¨λ“** | Ver.2.3 (iros_pubc_1.1.jar) | μΈμ¦, λ΅κΉ…, κ³µν†µ κΈ°λ¥ |

### 5.2 λΌμ΄λΈλ¬λ¦¬ μμ΅΄μ„±

**ν•„μ JAR νμΌ** (JDK 1.8 κΈ°μ¤€):
```
WEB-INF/lib/
β”β”€β”€ iros_pubc_1.1.jar                      # PUBC ν•µμ‹¬ λ¨λ“ (Ver.2.3)
β”β”€β”€ iros_cipher.jar                        # μ•”νΈν™”
β”β”€β”€ spring-core-4.3.30.jar                 # Spring Core
β”β”€β”€ spring-webmvc-4.3.30.jar               # Spring MVC
β”β”€β”€ spring-jdbc-4.3.30.jar                 # Spring JDBC
β”β”€β”€ cxf-core-3.3.13.jar                    # Apache CXF
β”β”€β”€ cxf-rt-frontend-jaxws-3.3.13.jar       # JAX-WS
β”β”€β”€ cxf-rt-frontend-jaxrs-3.3.13.jar       # JAX-RS
β”β”€β”€ mybatis-3.5.13.jar                     # MyBatis
β”β”€β”€ mybatis-spring-2.0.7.jar               # MyBatis-Spring
β”β”€β”€ ibatis-2.3.4.jar                       # iBATIS (PUBCμ©)
β”β”€β”€ logback-classic-1.2.12.jar             # Logback
β”β”€β”€ slf4j-api-1.7.36.jar                   # SLF4J
β”β”€β”€ jackson-databind-2.15.2.jar            # Jackson JSON
β”β”€β”€ jackson-core-2.15.2.jar                # Jackson Core
β””β”€β”€ [JDBC λ“λΌμ΄λ²„]                         # H2, MySQL, PostgreSQL, Tibero, CUBRID λ“±
```

### 5.3 λ°μ΄ν„°λ² μ΄μ¤

- **κ°λ°/ν…μ¤νΈ**: H2 Database (μΈλ©”λ¨λ¦¬)
- **μ΄μ**: Oracle, PostgreSQL, MySQL, Tibero, CUBRID λ“±
  - PUBC λ¨λ“μ€ 11μΆ… DBMS μ§€μ› (Oracle, Sybase, PostgreSQL, MySQL, Tibero, CUBRID, MS SQL Server, Informix, Altibase, UniSQL, κ³µν†µ SQL)

---

## 6. λ°°ν¬ μ•„ν‚¤ν…μ²

### 6.1 WAR νμΌ κµ¬μ΅°

```
pubc-test-api.war
β”β”€β”€ WEB-INF/
β”‚   β”β”€β”€ web.xml
β”‚   β”β”€β”€ classes/
β”‚   β”‚   β””β”€β”€ iros/test/...           # μ»΄νμΌλ ν΄λμ¤
β”‚   β”β”€β”€ lib/
β”‚   β”‚   β””β”€β”€ [λ¨λ“  μμ΅΄ JAR]
β”‚   β””β”€β”€ config/
β”‚       β””β”€β”€ [Spring, iBATIS μ„¤μ •]
β””β”€β”€ index.jsp
```

### 6.2 λ°°ν¬ ν™κ²½

**WAS**:
- Apache Tomcat 8.5.90 μ΄μƒ
- ν¬νΈ: 8080 (κΈ°λ³Έκ°’)
- JDK 1.8 ν•„μ

**λ°°ν¬ κ²½λ΅**:
- `http://localhost:8080/pubc-test-api/`

**μ—”λ“ν¬μΈνΈ**:
- REST: `http://localhost:8080/pubc-test-api/api/*`
- SOAP: `http://localhost:8080/pubc-test-api/services/*`

### 6.3 ν™κ²½λ³„ μ„¤μ •

**κ°λ° ν™κ²½**:
- μΈλ©”λ¨λ¦¬ DB (H2)
- λ΅κ·Έ λ λ²¨: DEBUG
- PUBC μΈμ¦ Mock κ°€λ¥

**ν…μ¤νΈ ν™κ²½**:
- ν…μ¤νΈ DB
- PUBC λ¨λ“ ν†µν•© ν…μ¤νΈ
- λ΅κ·Έ λ λ²¨: INFO

**μ΄μ ν™κ²½**:
- μ΄μ DB
- PUBC μ™„μ „ ν†µν•©
- λ΅κ·Έ λ λ²¨: WARN, ERROR
- μ„±λ¥ λ¨λ‹ν„°λ§

---

## 7. λ³΄μ• μ•„ν‚¤ν…μ²

### 7.1 μΈμ¦ λ©”μ»¤λ‹μ¦

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚               μ„λΉ„μ¤ν‚¤ κΈ°λ° μΈμ¦                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β”‚  β”‚ 1. μ„λΉ„μ¤ν‚¤ μ¶”μ¶ (Query Param λλ” Header)    β”‚  β”‚
β”‚  β”‚ 2. PUBC μΈμ¦ λ¨λ“ νΈμ¶                         β”‚  β”‚
β”‚  β”‚ 3. DB κ²€μ¦ (TN_PUBC_USER_CRTFC)                β”‚  β”‚
β”‚  β”‚ 4. IP κ²€μ¦                                     β”‚  β”‚
β”‚  β”‚ 5. μ‚¬μ©λ‰ μ„κ³„κ°’ κ²€μ¦                          β”‚  β”‚
β”‚  β”‚ 6. UserCrtfcVO λ°ν™ (troblTyCode)             β”‚  β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### 7.2 μ—λ¬ μ½”λ“ μ²΄κ³„

| μ½”λ“ | μ ν• | μ„¤λ… |
|------|------|------|
| `00` | μ •μƒ | μΈμ¦ μ„±κ³µ |
| `01` | μ‹μ¤ν… μ¤λ¥ | APPLICATION_ERROR |
| `02` | μ‹μ¤ν… μ¤λ¥ | DB_ERROR |
| `10` | μ”μ²­ μ¤λ¥ | INVALID_REQUEST_PARAMETER_ERROR |
| `11` | μ”μ²­ μ¤λ¥ | NO_MANDATORY_REQUEST_PARAMETERS_ERROR |
| `20` | μ ‘κ·Ό μ ν• | SERVICE_ACCESS_DENIED_ERROR |
| `22` | μ ‘κ·Ό μ ν• | LIMITED_NUMBER_OF_SERVICE_REQUESTS_EXCEEDS_ERROR |
| `30` | μ„λΉ„μ¤ν‚¤ μ¤λ¥ | SERVICE_KEY_IS_NOT_REGISTERED_ERROR |
| `31` | μ„λΉ„μ¤ν‚¤ μ¤λ¥ | DEADLINE_HAS_EXPIRED_ERROR |
| `32` | μ„λΉ„μ¤ν‚¤ μ¤λ¥ | UNREGISTERED_IP_ERROR |
| `99` | κΈ°νƒ€ μ¤λ¥ | μμ™Έ μ²λ¦¬ |

### 7.3 SQL Injection λ°©μ–΄

- **iBATIS PreparedStatement μ‚¬μ©**
- **νλΌλ―Έν„° λ°”μΈλ”©** (`#param#` μ‚¬μ©)
- **μ…λ ¥κ°’ κ²€μ¦**

---

## 8. μ„±λ¥ κ³ λ ¤μ‚¬ν•­

### 8.1 Connection Pool μ„¤μ •

```xml
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
      destroy-method="close">
    <property name="driverClassName" value="${jdbc.driver}"/>
    <property name="url" value="${jdbc.url}"/>
    <property name="username" value="${jdbc.username}"/>
    <property name="password" value="${jdbc.password}"/>
    <property name="initialSize" value="5"/>
    <property name="maxActive" value="20"/>
    <property name="maxIdle" value="10"/>
    <property name="minIdle" value="5"/>
    <property name="maxWait" value="10000"/>
</bean>
```

### 8.2 μΊμ‹± μ „λµ

- **μ„λΉ„μ¤ν‚¤ κ²€μ¦ κ²°κ³Ό**: λ‹¨κΈ° μΊμ‹± (1λ¶„)
- **μ‚¬μ©μ μ •λ³΄**: μΊμ‹± λ―Έμ μ© (μ‹¤μ‹κ°„ μ΅°ν)

### 8.3 λ΅κΉ… μµμ ν™”

- **λΉ„λ™κΈ° λ΅κΉ…**: PUBC λ΅κΉ…μ€ finally λΈ”λ΅μ—μ„ μ²λ¦¬
- **λ°°μΉ λ΅κΉ…**: λ€λ‰ μ”μ²­ μ‹ λ°°μΉ Insert κ³ λ ¤

---

## 9. λ¨λ‹ν„°λ§ λ° λ΅κΉ…

### 9.1 λ΅κΉ… λ λ²¨

```xml
<logger name="iros.test" level="DEBUG"/>
<logger name="iros.pubc" level="INFO"/>
<logger name="org.springframework" level="WARN"/>
<logger name="org.apache.cxf" level="INFO"/>
```

### 9.2 λ¨λ‹ν„°λ§ ν¬μΈνΈ

- API μ‘λ‹µ μ‹κ°„
- μΈμ¦ μ„±κ³µ/μ‹¤ν¨ λΉ„μ¨
- λ°μ΄ν„°λ² μ΄μ¤ μ»¤λ„¥μ… ν’€ μƒνƒ
- PUBC λ΅κΉ… μ„±κ³µλ¥ 

---

## 10. ν™•μ¥ κ³ λ ¤μ‚¬ν•­

### 10.1 μ¶”κ°€ API κ°λ°

- λ™μΌν• ν¨ν„΄μΌλ΅ μƒλ΅μ΄ λ„λ©”μΈ μ¶”κ°€
- CommonProc μ¬μ‚¬μ©

### 10.2 λ©”μ‹μ§€ ν ν†µν•© (μ„ νƒ)

- λ€λ‰ λ΅κΉ… μ²λ¦¬ μ‹ MQ ν™μ© κ°€λ¥

### 10.3 λ§μ΄ν¬λ΅μ„λΉ„μ¤ μ „ν™ (μ¥κΈ°)

- κ° λ„λ©”μΈμ„ λ…λ¦½ μ„λΉ„μ¤λ΅ λ¶„λ¦¬
- PUBC λ¨λ“μ€ κ³µν†µ λΌμ΄λΈλ¬λ¦¬λ΅ μ μ§€

---

## λ¶€λ΅: Spring μ„¤μ • μμ‹

### A.1 context-app.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-2.5.xsd">

    <!-- Component Scan -->
    <context:component-scan base-package="iros.test"/>

    <!-- PUBC μ„¤μ • Import -->
    <import resource="classpath:iros/pubc/spring/context-common-pubc.xml"/>
    <import resource="classpath:iros/pubc/spring/context-datasource-pubc.xml"/>
    <import resource="classpath:iros/pubc/spring/context-sqlMap-pubc.xml"/>

</beans>
```

### A.2 context-cxf.xml (μ΅°ν μ „μ©)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jaxws="http://cxf.apache.org/jaxws"
       xmlns:jaxrs="http://cxf.apache.org/jaxrs"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-4.3.xsd
           http://cxf.apache.org/jaxws
           http://cxf.apache.org/schemas/jaxws.xsd
           http://cxf.apache.org/jaxrs
           http://cxf.apache.org/schemas/jaxrs.xsd">

    <!-- JAX-WS SOAP Service (μ΅°ν μ „μ©) -->
    <jaxws:endpoint id="cultureFacilitySoapService"
                    implementor="#cultureFacilitySoapServiceBean"
                    address="/CultureFacilityService"/>

    <!-- JAX-RS REST Service (μ΅°ν μ „μ©) -->
    <jaxrs:server id="restServices" address="/api">
        <jaxrs:serviceBeans>
            <ref bean="cultureFacilityRestController"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <bean class="com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider"/>
        </jaxrs:providers>
    </jaxrs:server>

</beans>
```

---

**μ‘μ„±μ**: Claude
**λ²„μ „**: 2.0 (μ΅°ν μ „μ© API)
**μµμΆ… μμ •μΌ**: 2025-11-04
